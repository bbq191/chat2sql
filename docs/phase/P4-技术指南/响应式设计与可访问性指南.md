# ğŸ“± å“åº”å¼è®¾è®¡ä¸å¯è®¿é—®æ€§æŒ‡å—

## ğŸ¯ è®¾è®¡ç†å¿µ

Chat2SQLçš„å‰ç«¯ç•Œé¢é‡‡ç”¨ç§»åŠ¨ä¼˜å…ˆçš„å“åº”å¼è®¾è®¡ï¼Œç¡®ä¿åœ¨å„ç§è®¾å¤‡å’Œèƒ½åŠ›çš„ç”¨æˆ·éƒ½èƒ½è·å¾—ä¼˜ç§€çš„ä½¿ç”¨ä½“éªŒã€‚æœ¬æŒ‡å—è¯¦ç»†ä»‹ç»P4é˜¶æ®µçš„å“åº”å¼è®¾è®¡å’Œå¯è®¿é—®æ€§å®ç°ç­–ç•¥ã€‚

### âœ¨ æ ¸å¿ƒè®¾è®¡åŸåˆ™

| è®¾è®¡åŸåˆ™ | å®ç°ç­–ç•¥ | ç›®æ ‡æŒ‡æ ‡ | ä¸šåŠ¡ä»·å€¼ |
|---------|---------|---------|---------|
| **ç§»åŠ¨ä¼˜å…ˆ** | Progressive Enhancement | ç§»åŠ¨ç«¯ç”¨æˆ·>70% | æ‰©å¤§ç”¨æˆ·è¦†ç›–é¢ |
| **æ— éšœç¢è®¿é—®** | WCAG 2.1 AAæ ‡å‡† | å¯è®¿é—®æ€§å¾—åˆ†>95 | åŒ…å®¹æ€§è®¾è®¡ |
| **æ€§èƒ½å¯¼å‘** | æ ¸å¿ƒWebæŒ‡æ ‡ä¼˜åŒ– | LCP<2.5s, FID<100ms | ç”¨æˆ·ä½“éªŒæå‡ |
| **å†…å®¹ä¼˜å…ˆ** | è¯­ä¹‰åŒ–HTMLç»“æ„ | SEOå¾—åˆ†>90 | æœç´¢å¼•æ“å‹å¥½ |

### ğŸ ç”¨æˆ·ä½“éªŒç›®æ ‡

- **è·¨è®¾å¤‡ä¸€è‡´æ€§**ï¼šæ¡Œé¢ç«¯ã€å¹³æ¿ç«¯ã€ç§»åŠ¨ç«¯ä½“éªŒç»Ÿä¸€
- **å¿«é€Ÿå“åº”**ï¼šæ‰€æœ‰äº¤äº’æ“ä½œå“åº”æ—¶é—´<200ms
- **ç›´è§‚æ“ä½œ**ï¼šæ–°ç”¨æˆ·5åˆ†é’Ÿå†…å®Œæˆé¦–æ¬¡æŸ¥è¯¢
- **åŒ…å®¹æ€§è®¾è®¡**ï¼šæ”¯æŒè§†è§‰ã€å¬è§‰ã€è¿åŠ¨èƒ½åŠ›å—é™ç”¨æˆ·

---

## ğŸ“ å“åº”å¼å¸ƒå±€æ¶æ„

### ğŸ¨ æ–­ç‚¹ç³»ç»Ÿè®¾è®¡

```scss
// å“åº”å¼æ–­ç‚¹å®šä¹‰
$breakpoints: (
  // ç§»åŠ¨ç«¯ä¼˜å…ˆè®¾è®¡
  xs: 0,          // Extra small devices (>0px)
  sm: 576px,      // Small devices (landscape phones, â‰¥576px)
  md: 768px,      // Medium devices (tablets, â‰¥768px)
  lg: 992px,      // Large devices (desktops, â‰¥992px)
  xl: 1200px,     // Extra large devices (large desktops, â‰¥1200px)
  xxl: 1400px     // Extra extra large devices (â‰¥1400px)
);

// åª’ä½“æŸ¥è¯¢æ··å…¥
@mixin media-breakpoint-up($name) {
  $min: map-get($breakpoints, $name);
  @media (min-width: $min) {
    @content;
  }
}

@mixin media-breakpoint-down($name) {
  $max: map-get($breakpoints, $name) - 0.02;
  @media (max-width: $max) {
    @content;
  }
}

@mixin media-breakpoint-between($lower, $upper) {
  $min: map-get($breakpoints, $lower);
  $max: map-get($breakpoints, $upper) - 0.02;
  @media (min-width: $min) and (max-width: $max) {
    @content;
  }
}

// å®¹å™¨ç³»ç»Ÿ
.container {
  width: 100%;
  padding-left: 15px;
  padding-right: 15px;
  margin-left: auto;
  margin-right: auto;
  
  @include media-breakpoint-up(sm) {
    max-width: 540px;
  }
  
  @include media-breakpoint-up(md) {
    max-width: 720px;
  }
  
  @include media-breakpoint-up(lg) {
    max-width: 960px;
  }
  
  @include media-breakpoint-up(xl) {
    max-width: 1140px;
  }
  
  @include media-breakpoint-up(xxl) {
    max-width: 1320px;
  }
}
```

### ğŸ—ï¸ ç½‘æ ¼ç³»ç»Ÿå®ç°

```tsx
// å“åº”å¼ç½‘æ ¼ç»„ä»¶
interface GridProps {
  cols?: {
    xs?: number;
    sm?: number;
    md?: number;
    lg?: number;
    xl?: number;
    xxl?: number;
  };
  gap?: number | string;
  children: React.ReactNode;
}

function ResponsiveGrid({ cols = { xs: 1, md: 2, lg: 3 }, gap = 16, children }: GridProps) {
  const gridStyles: React.CSSProperties = {
    display: 'grid',
    gap,
    gridTemplateColumns: `repeat(${cols.xs || 1}, 1fr)`
  };
  
  const mediaQueries = {
    [`@media (min-width: 576px)`]: {
      gridTemplateColumns: `repeat(${cols.sm || cols.xs || 1}, 1fr)`
    },
    [`@media (min-width: 768px)`]: {
      gridTemplateColumns: `repeat(${cols.md || cols.sm || cols.xs || 1}, 1fr)`
    },
    [`@media (min-width: 992px)`]: {
      gridTemplateColumns: `repeat(${cols.lg || cols.md || cols.sm || cols.xs || 1}, 1fr)`
    },
    [`@media (min-width: 1200px)`]: {
      gridTemplateColumns: `repeat(${cols.xl || cols.lg || cols.md || cols.sm || cols.xs || 1}, 1fr)`
    },
    [`@media (min-width: 1400px)`]: {
      gridTemplateColumns: `repeat(${cols.xxl || cols.xl || cols.lg || cols.md || cols.sm || cols.xs || 1}, 1fr)`
    }
  };
  
  return (
    <div 
      className="responsive-grid"
      style={gridStyles}
      css={mediaQueries}
    >
      {children}
    </div>
  );
}
```

### ğŸ“± ç§»åŠ¨ç«¯ä¼˜åŒ–å¸ƒå±€

```tsx
// ç§»åŠ¨ç«¯ä¸»ç•Œé¢å¸ƒå±€
function MobileLayout() {
  const [activeTab, setActiveTab] = useState('query');
  const isMobile = useMediaQuery('(max-width: 768px)');
  
  if (!isMobile) {
    return <DesktopLayout />;
  }
  
  return (
    <div className="mobile-layout">
      {/* é¡¶éƒ¨å¯¼èˆªæ  */}
      <header className="mobile-header">
        <div className="header-content">
          <div className="logo">
            <img src="/logo.svg" alt="Chat2SQL" />
          </div>
          
          <div className="header-actions">
            <Button 
              type="text" 
              icon={<Icon name="user" />}
              aria-label="ç”¨æˆ·èœå•"
            />
            <Button 
              type="text" 
              icon={<Icon name="settings" />}
              aria-label="è®¾ç½®"
            />
          </div>
        </div>
      </header>
      
      {/* ä¸»å†…å®¹åŒºåŸŸ */}
      <main className="mobile-main">
        {activeTab === 'query' && <QueryInterface />}
        {activeTab === 'history' && <QueryHistory />}
        {activeTab === 'favorites' && <FavoriteQueries />}
        {activeTab === 'settings' && <SettingsPanel />}
      </main>
      
      {/* åº•éƒ¨å¯¼èˆªæ  */}
      <nav className="mobile-navigation" role="navigation">
        <div className="nav-tabs">
          <button
            className={`nav-tab ${activeTab === 'query' ? 'active' : ''}`}
            onClick={() => setActiveTab('query')}
            aria-label="æŸ¥è¯¢"
            aria-current={activeTab === 'query' ? 'page' : undefined}
          >
            <Icon name="search" />
            <span>æŸ¥è¯¢</span>
          </button>
          
          <button
            className={`nav-tab ${activeTab === 'history' ? 'active' : ''}`}
            onClick={() => setActiveTab('history')}
            aria-label="å†å²"
            aria-current={activeTab === 'history' ? 'page' : undefined}
          >
            <Icon name="history" />
            <span>å†å²</span>
          </button>
          
          <button
            className={`nav-tab ${activeTab === 'favorites' ? 'active' : ''}`}
            onClick={() => setActiveTab('favorites')}
            aria-label="æ”¶è—"
            aria-current={activeTab === 'favorites' ? 'page' : undefined}
          >
            <Icon name="heart" />
            <span>æ”¶è—</span>
          </button>
          
          <button
            className={`nav-tab ${activeTab === 'settings' ? 'active' : ''}`}
            onClick={() => setActiveTab('settings')}
            aria-label="è®¾ç½®"
            aria-current={activeTab === 'settings' ? 'page' : undefined}
          >
            <Icon name="settings" />
            <span>è®¾ç½®</span>
          </button>
        </div>
      </nav>
    </div>
  );
}
```

### ğŸ–¥ï¸ æ¡Œé¢ç«¯è‡ªé€‚åº”å¸ƒå±€

```tsx
// æ¡Œé¢ç«¯ä¸‰æ å¸ƒå±€
function DesktopLayout() {
  const [sidebarCollapsed, setSidebarCollapsed] = useState(false);
  const [rightPanelVisible, setRightPanelVisible] = useState(true);
  
  return (
    <div className="desktop-layout">
      {/* å·¦ä¾§è¾¹æ  */}
      <aside 
        className={`sidebar ${sidebarCollapsed ? 'collapsed' : ''}`}
        aria-label="ä¾§è¾¹æ "
      >
        <div className="sidebar-header">
          <img src="/logo.svg" alt="Chat2SQL" className="logo" />
          
          <Button
            type="text"
            icon={<Icon name={sidebarCollapsed ? 'menu-unfold' : 'menu-fold'} />}
            onClick={() => setSidebarCollapsed(!sidebarCollapsed)}
            aria-label={sidebarCollapsed ? 'å±•å¼€ä¾§è¾¹æ ' : 'æ”¶èµ·ä¾§è¾¹æ '}
          />
        </div>
        
        <nav className="sidebar-navigation" role="navigation">
          <QueryHistory collapsed={sidebarCollapsed} />
          <FavoriteQueries collapsed={sidebarCollapsed} />
          <RecentConnections collapsed={sidebarCollapsed} />
        </nav>
      </aside>
      
      {/* ä¸»å†…å®¹åŒº */}
      <main className="main-content">
        <header className="main-header">
          <div className="header-title">
            <h1>SQLæŸ¥è¯¢å·¥ä½œå°</h1>
          </div>
          
          <div className="header-actions">
            <Button
              icon={<Icon name="panel-right" />}
              onClick={() => setRightPanelVisible(!rightPanelVisible)}
              aria-label={rightPanelVisible ? 'éšè—å³ä¾§é¢æ¿' : 'æ˜¾ç¤ºå³ä¾§é¢æ¿'}
            >
              {rightPanelVisible ? 'éšè—é¢æ¿' : 'æ˜¾ç¤ºé¢æ¿'}
            </Button>
          </div>
        </header>
        
        <div className="query-workspace">
          <QueryEditor />
          <QueryResults />
        </div>
      </main>
      
      {/* å³ä¾§é¢æ¿ */}
      {rightPanelVisible && (
        <aside className="right-panel" aria-label="è¾…åŠ©é¢æ¿">
          <div className="panel-tabs">
            <QueryAssistant />
            <QueryHistory />
            <PerformanceMetrics />
          </div>
        </aside>
      )}
    </div>
  );
}
```

---

## â™¿ å¯è®¿é—®æ€§ (WCAG 2.1) å®ç°

### ğŸ¯ WCAG 2.1 AAæ ‡å‡†éµå¾ª

```tsx
// å¯è®¿é—®æ€§ç»„ä»¶åŸºç±»
interface AccessibleComponentProps {
  id?: string;
  'aria-label'?: string;
  'aria-labelledby'?: string;
  'aria-describedby'?: string;
  role?: string;
  tabIndex?: number;
}

// å¯è®¿é—®çš„æŸ¥è¯¢è¾“å…¥ç»„ä»¶
function AccessibleQueryInput({
  value,
  onChange,
  onSubmit,
  loading,
  error,
  ...accessibilityProps
}: {
  value: string;
  onChange: (value: string) => void;
  onSubmit: () => void;
  loading?: boolean;
  error?: string;
} & AccessibleComponentProps) {
  const inputId = accessibilityProps.id || `query-input-${Date.now()}`;
  const errorId = `${inputId}-error`;
  const helpId = `${inputId}-help`;
  
  return (
    <div className="accessible-query-input">
      {/* æŸ¥è¯¢è¾“å…¥æ ‡ç­¾ */}
      <label htmlFor={inputId} className="query-label">
        è¾“å…¥æ‚¨çš„è‡ªç„¶è¯­è¨€æŸ¥è¯¢
        <span className="required-indicator" aria-label="å¿…å¡«">*</span>
      </label>
      
      {/* å¸®åŠ©æ–‡æœ¬ */}
      <div id={helpId} className="help-text">
        ä¾‹å¦‚ï¼šæ˜¾ç¤ºæœ€è¿‘ä¸€å‘¨çš„è®¢å•æ•°æ®
      </div>
      
      {/* æŸ¥è¯¢è¾“å…¥æ¡† */}
      <textarea
        id={inputId}
        value={value}
        onChange={(e) => onChange(e.target.value)}
        className={`query-textarea ${error ? 'error' : ''}`}
        placeholder="è¯·è¾“å…¥æ‚¨çš„æŸ¥è¯¢..."
        aria-describedby={`${helpId} ${error ? errorId : ''}`}
        aria-invalid={error ? 'true' : 'false'}
        aria-required="true"
        rows={4}
        disabled={loading}
        {...accessibilityProps}
      />
      
      {/* é”™è¯¯ä¿¡æ¯ */}
      {error && (
        <div 
          id={errorId} 
          className="error-message" 
          role="alert"
          aria-live="polite"
        >
          <Icon name="exclamation-circle" aria-hidden="true" />
          {error}
        </div>
      )}
      
      {/* æäº¤æŒ‰é’® */}
      <Button
        type="primary"
        onClick={onSubmit}
        loading={loading}
        disabled={!value.trim() || loading}
        aria-describedby={loading ? `${inputId}-status` : undefined}
      >
        {loading ? 'æ­£åœ¨æ‰§è¡ŒæŸ¥è¯¢...' : 'æ‰§è¡ŒæŸ¥è¯¢'}
      </Button>
      
      {/* åŠ è½½çŠ¶æ€ */}
      {loading && (
        <div 
          id={`${inputId}-status`}
          className="loading-status"
          aria-live="polite"
          aria-atomic="true"
        >
          æ­£åœ¨å¤„ç†æ‚¨çš„æŸ¥è¯¢ï¼Œè¯·ç¨å€™...
        </div>
      )}
    </div>
  );
}
```

### ğŸ¨ é«˜å¯¹æ¯”åº¦ä¸»é¢˜æ”¯æŒ

```scss
// é«˜å¯¹æ¯”åº¦ä¸»é¢˜
@media (prefers-contrast: high) {
  :root {
    --primary-color: #000000;
    --background-color: #ffffff;
    --text-color: #000000;
    --border-color: #000000;
    --error-color: #cc0000;
    --success-color: #006600;
    --warning-color: #996600;
    --info-color: #0066cc;
  }
  
  .query-interface {
    border: 2px solid var(--border-color);
    background: var(--background-color);
    color: var(--text-color);
  }
  
  .button {
    border: 2px solid var(--primary-color);
    background: var(--background-color);
    color: var(--primary-color);
    
    &:hover {
      background: var(--primary-color);
      color: var(--background-color);
    }
    
    &:focus {
      outline: 3px solid var(--primary-color);
      outline-offset: 2px;
    }
  }
}

// æš—è‰²ä¸»é¢˜å¯è®¿é—®æ€§
@media (prefers-color-scheme: dark) {
  :root {
    --background-color: #121212;
    --surface-color: #1e1e1e;
    --text-color: #ffffff;
    --text-secondary: #b3b3b3;
    --border-color: #333333;
  }
  
  // ç¡®ä¿æš—è‰²ä¸»é¢˜ä¸‹çš„å¯¹æ¯”åº¦
  .query-results-table {
    --row-hover-bg: rgba(255, 255, 255, 0.04);
    --row-selected-bg: rgba(64, 169, 255, 0.16);
  }
}

// åŠ¨ç”»å‡å°‘åå¥½
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}
```

### âŒ¨ï¸ é”®ç›˜å¯¼èˆªæ”¯æŒ

```tsx
// é”®ç›˜å¯¼èˆªHook
function useKeyboardNavigation() {
  const [focusedElement, setFocusedElement] = useState<HTMLElement | null>(null);
  const [navigationMode, setNavigationMode] = useState<'mouse' | 'keyboard'>('mouse');
  
  useEffect(() => {
    // æ£€æµ‹å¯¼èˆªæ¨¡å¼
    const handleKeyDown = (e: KeyboardEvent) => {
      if (e.key === 'Tab') {
        setNavigationMode('keyboard');
      }
    };
    
    const handleMouseDown = () => {
      setNavigationMode('mouse');
    };
    
    document.addEventListener('keydown', handleKeyDown);
    document.addEventListener('mousedown', handleMouseDown);
    
    return () => {
      document.removeEventListener('keydown', handleKeyDown);
      document.removeEventListener('mousedown', handleMouseDown);
    };
  }, []);
  
  // è·³è¿‡é“¾æ¥åŠŸèƒ½
  const createSkipLink = useCallback((targetId: string, label: string) => {
    return (
      <a 
        href={`#${targetId}`}
        className="skip-link"
        onFocus={() => setNavigationMode('keyboard')}
      >
        {label}
      </a>
    );
  }, []);
  
  return {
    navigationMode,
    focusedElement,
    createSkipLink
  };
}

// æŸ¥è¯¢ç»“æœè¡¨æ ¼é”®ç›˜å¯¼èˆª
function AccessibleDataTable({ data, columns }: { data: any[], columns: any[] }) {
  const [focusedCell, setFocusedCell] = useState({ row: 0, col: 0 });
  const tableRef = useRef<HTMLTableElement>(null);
  
  const handleKeyDown = useCallback((e: KeyboardEvent) => {
    if (!tableRef.current) return;
    
    const rowCount = data.length;
    const colCount = columns.length;
    
    switch (e.key) {
      case 'ArrowUp':
        e.preventDefault();
        setFocusedCell(prev => ({
          ...prev,
          row: Math.max(0, prev.row - 1)
        }));
        break;
        
      case 'ArrowDown':
        e.preventDefault();
        setFocusedCell(prev => ({
          ...prev,
          row: Math.min(rowCount - 1, prev.row + 1)
        }));
        break;
        
      case 'ArrowLeft':
        e.preventDefault();
        setFocusedCell(prev => ({
          ...prev,
          col: Math.max(0, prev.col - 1)
        }));
        break;
        
      case 'ArrowRight':
        e.preventDefault();
        setFocusedCell(prev => ({
          ...prev,
          col: Math.min(colCount - 1, prev.col + 1)
        }));
        break;
        
      case 'Home':
        e.preventDefault();
        if (e.ctrlKey) {
          setFocusedCell({ row: 0, col: 0 });
        } else {
          setFocusedCell(prev => ({ ...prev, col: 0 }));
        }
        break;
        
      case 'End':
        e.preventDefault();
        if (e.ctrlKey) {
          setFocusedCell({ row: rowCount - 1, col: colCount - 1 });
        } else {
          setFocusedCell(prev => ({ ...prev, col: colCount - 1 }));
        }
        break;
    }
  }, [data.length, columns.length]);
  
  useEffect(() => {
    const table = tableRef.current;
    if (table) {
      table.addEventListener('keydown', handleKeyDown);
      return () => table.removeEventListener('keydown', handleKeyDown);
    }
  }, [handleKeyDown]);
  
  return (
    <div className="accessible-table-container">
      <div className="table-caption" id="table-description">
        æŸ¥è¯¢ç»“æœè¡¨æ ¼ï¼ŒåŒ…å« {data.length} è¡Œæ•°æ®ï¼Œ{columns.length} åˆ—
      </div>
      
      <table 
        ref={tableRef}
        className="accessible-data-table"
        role="grid"
        aria-labelledby="table-description"
        tabIndex={0}
      >
        <thead>
          <tr role="row">
            {columns.map((column, colIndex) => (
              <th 
                key={column.key}
                role="columnheader"
                aria-sort="none"
                tabIndex={-1}
              >
                {column.title}
              </th>
            ))}
          </tr>
        </thead>
        
        <tbody>
          {data.map((row, rowIndex) => (
            <tr key={rowIndex} role="row">
              {columns.map((column, colIndex) => (
                <td
                  key={`${rowIndex}-${colIndex}`}
                  role="gridcell"
                  tabIndex={
                    focusedCell.row === rowIndex && focusedCell.col === colIndex ? 0 : -1
                  }
                  className={
                    focusedCell.row === rowIndex && focusedCell.col === colIndex 
                      ? 'focused' : ''
                  }
                  aria-describedby={`cell-${rowIndex}-${colIndex}-desc`}
                >
                  {row[column.dataIndex]}
                  <span 
                    id={`cell-${rowIndex}-${colIndex}-desc`}
                    className="sr-only"
                  >
                    ç¬¬ {rowIndex + 1} è¡Œï¼Œ{column.title}ï¼š{row[column.dataIndex]}
                  </span>
                </td>
              ))}
            </tr>
          ))}
        </tbody>
      </table>
      
      <div className="table-instructions sr-only">
        ä½¿ç”¨æ–¹å‘é”®å¯¼èˆªè¡¨æ ¼ï¼ŒHomeé”®å›åˆ°è¡Œé¦–ï¼ŒEndé”®åˆ°è¡Œå°¾ï¼ŒCtrl+Homeå›åˆ°è¡¨æ ¼å¼€å¤´ï¼ŒCtrl+Endåˆ°è¡¨æ ¼ç»“å°¾
      </div>
    </div>
  );
}
```

### ğŸ”Š å±å¹•é˜…è¯»å™¨æ”¯æŒ

```tsx
// å±å¹•é˜…è¯»å™¨å‹å¥½çš„æŸ¥è¯¢çŠ¶æ€ç»„ä»¶
function ScreenReaderQueryStatus({ status, progress, error }: {
  status: 'idle' | 'executing' | 'completed' | 'error';
  progress?: number;
  error?: string;
}) {
  const [announcements, setAnnouncements] = useState<string[]>([]);
  
  // çŠ¶æ€å˜åŒ–æ—¶çš„è¯­éŸ³æç¤º
  useEffect(() => {
    let announcement = '';
    
    switch (status) {
      case 'executing':
        announcement = `å¼€å§‹æ‰§è¡ŒæŸ¥è¯¢${progress ? `ï¼Œå½“å‰è¿›åº¦ ${progress}%` : ''}`;
        break;
      case 'completed':
        announcement = 'æŸ¥è¯¢æ‰§è¡Œå®Œæˆï¼Œç»“æœå·²æ˜¾ç¤º';
        break;
      case 'error':
        announcement = `æŸ¥è¯¢æ‰§è¡Œå¤±è´¥ï¼š${error}`;
        break;
    }
    
    if (announcement) {
      setAnnouncements(prev => [...prev, announcement]);
      
      // æ¸…ç†æ—§çš„é€šçŸ¥
      setTimeout(() => {
        setAnnouncements(prev => prev.slice(1));
      }, 5000);
    }
  }, [status, progress, error]);
  
  return (
    <>
      {/* çŠ¶æ€åŒºåŸŸ - å±å¹•é˜…è¯»å™¨å¯è§ */}
      <div className="sr-only" role="status" aria-live="polite">
        {announcements.map((announcement, index) => (
          <div key={index}>{announcement}</div>
        ))}
      </div>
      
      {/* è¿›åº¦æŒ‡ç¤ºå™¨ */}
      {status === 'executing' && (
        <div 
          role="progressbar"
          aria-valuemin={0}
          aria-valuemax={100}
          aria-valuenow={progress || 0}
          aria-label={`æŸ¥è¯¢æ‰§è¡Œè¿›åº¦ï¼š${progress || 0}%`}
          className="query-progress"
        >
          <div 
            className="progress-bar"
            style={{ width: `${progress || 0}%` }}
          />
        </div>
      )}
    </>
  );
}

// è¯­éŸ³åé¦ˆHook
function useSpeechFeedback() {
  const speak = useCallback((text: string, options?: SpeechSynthesisUtteranceOptions) => {
    if ('speechSynthesis' in window) {
      const utterance = new SpeechSynthesisUtterance(text);
      
      if (options) {
        Object.assign(utterance, options);
      }
      
      // é»˜è®¤è®¾ç½®
      utterance.rate = 1;
      utterance.pitch = 1;
      utterance.volume = 0.8;
      utterance.lang = 'zh-CN';
      
      speechSynthesis.speak(utterance);
    }
  }, []);
  
  const stop = useCallback(() => {
    if ('speechSynthesis' in window) {
      speechSynthesis.cancel();
    }
  }, []);
  
  return { speak, stop };
}
```

---

## ğŸ“± PWA (æ¸è¿›å¼Webåº”ç”¨) å®ç°

### ğŸ› ï¸ Service Workeré…ç½®

```typescript
// service-worker.ts
const CACHE_NAME = 'chat2sql-v1';
const OFFLINE_URL = '/offline.html';

// éœ€è¦ç¼“å­˜çš„èµ„æº
const CACHE_RESOURCES = [
  '/',
  '/static/js/main.js',
  '/static/css/main.css',
  '/static/images/logo.svg',
  '/offline.html'
];

// å®‰è£…äº‹ä»¶
self.addEventListener('install', (event: ExtendableEvent) => {
  event.waitUntil(
    caches.open(CACHE_NAME)
      .then(cache => cache.addAll(CACHE_RESOURCES))
      .then(() => self.skipWaiting())
  );
});

// æ¿€æ´»äº‹ä»¶
self.addEventListener('activate', (event: ExtendableEvent) => {
  event.waitUntil(
    caches.keys()
      .then(cacheNames => {
        return Promise.all(
          cacheNames
            .filter(cacheName => cacheName !== CACHE_NAME)
            .map(cacheName => caches.delete(cacheName))
        );
      })
      .then(() => self.clients.claim())
  );
});

// è¯·æ±‚æ‹¦æˆª
self.addEventListener('fetch', (event: FetchEvent) => {
  // åªå¤„ç†GETè¯·æ±‚
  if (event.request.method !== 'GET') {
    return;
  }
  
  event.respondWith(
    caches.match(event.request)
      .then(response => {
        if (response) {
          return response;
        }
        
        return fetch(event.request)
          .then(response => {
            // æ£€æŸ¥å“åº”æ˜¯å¦æœ‰æ•ˆ
            if (!response || response.status !== 200 || response.type !== 'basic') {
              return response;
            }
            
            // å…‹éš†å“åº”è¿›è¡Œç¼“å­˜
            const responseToCache = response.clone();
            
            caches.open(CACHE_NAME)
              .then(cache => {
                cache.put(event.request, responseToCache);
              });
            
            return response;
          })
          .catch(() => {
            // ç½‘ç»œå¤±è´¥æ—¶è¿”å›ç¦»çº¿é¡µé¢
            if (event.request.destination === 'document') {
              return caches.match(OFFLINE_URL);
            }
          });
      })
  );
});

// åå°åŒæ­¥
self.addEventListener('sync', (event: SyncEvent) => {
  if (event.tag === 'query-sync') {
    event.waitUntil(syncPendingQueries());
  }
});

async function syncPendingQueries() {
  // åŒæ­¥ç¦»çº¿æœŸé—´çš„æŸ¥è¯¢
  const pendingQueries = await getPendingQueries();
  
  for (const query of pendingQueries) {
    try {
      await submitQuery(query);
      await removePendingQuery(query.id);
    } catch (error) {
      console.error('æŸ¥è¯¢åŒæ­¥å¤±è´¥:', error);
    }
  }
}
```

### ğŸ“± Web App Manifest

```json
{
  "name": "Chat2SQL - è‡ªç„¶è¯­è¨€SQLæŸ¥è¯¢å·¥å…·",
  "short_name": "Chat2SQL",
  "description": "åŸºäºAIçš„è‡ªç„¶è¯­è¨€è½¬SQLæŸ¥è¯¢å·¥å…·ï¼Œæ”¯æŒå¤šæ•°æ®åº“å’Œæ™ºèƒ½ç¼“å­˜",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#ffffff",
  "theme_color": "#1890ff",
  "orientation": "portrait-primary",
  "icons": [
    {
      "src": "/icons/icon-72x72.png",
      "sizes": "72x72",
      "type": "image/png",
      "purpose": "maskable any"
    },
    {
      "src": "/icons/icon-96x96.png",
      "sizes": "96x96",
      "type": "image/png",
      "purpose": "maskable any"
    },
    {
      "src": "/icons/icon-128x128.png",
      "sizes": "128x128",
      "type": "image/png",
      "purpose": "maskable any"
    },
    {
      "src": "/icons/icon-144x144.png",
      "sizes": "144x144",
      "type": "image/png",
      "purpose": "maskable any"
    },
    {
      "src": "/icons/icon-152x152.png",
      "sizes": "152x152",
      "type": "image/png",
      "purpose": "maskable any"
    },
    {
      "src": "/icons/icon-192x192.png",
      "sizes": "192x192",
      "type": "image/png",
      "purpose": "maskable any"
    },
    {
      "src": "/icons/icon-384x384.png",
      "sizes": "384x384",
      "type": "image/png",
      "purpose": "maskable any"
    },
    {
      "src": "/icons/icon-512x512.png",
      "sizes": "512x512",
      "type": "image/png",
      "purpose": "maskable any"
    }
  ],
  "categories": ["productivity", "business"],
  "screenshots": [
    {
      "src": "/screenshots/desktop.png",
      "sizes": "1280x720",
      "type": "image/png",
      "platform": "wide",
      "label": "æ¡Œé¢ç«¯ç•Œé¢"
    },
    {
      "src": "/screenshots/mobile.png",
      "sizes": "375x667",
      "type": "image/png",
      "platform": "narrow",
      "label": "ç§»åŠ¨ç«¯ç•Œé¢"
    }
  ],
  "shortcuts": [
    {
      "name": "æ–°å»ºæŸ¥è¯¢",
      "short_name": "æ–°æŸ¥è¯¢",
      "description": "å¿«é€Ÿåˆ›å»ºæ–°çš„SQLæŸ¥è¯¢",
      "url": "/query/new",
      "icons": [
        {
          "src": "/icons/shortcut-new.png",
          "sizes": "96x96"
        }
      ]
    },
    {
      "name": "æŸ¥è¯¢å†å²",
      "short_name": "å†å²",
      "description": "æŸ¥çœ‹å†å²æŸ¥è¯¢è®°å½•",
      "url": "/history",
      "icons": [
        {
          "src": "/icons/shortcut-history.png",
          "sizes": "96x96"
        }
      ]
    }
  ]
}
```

### ğŸ”„ ç¦»çº¿åŠŸèƒ½å®ç°

```tsx
// ç¦»çº¿çŠ¶æ€ç®¡ç†Hook
function useOfflineCapability() {
  const [isOnline, setIsOnline] = useState(navigator.onLine);
  const [pendingQueries, setPendingQueries] = useState<any[]>([]);
  
  useEffect(() => {
    const handleOnline = () => {
      setIsOnline(true);
      // åŒæ­¥ç¦»çº¿æœŸé—´çš„æŸ¥è¯¢
      syncPendingQueries();
    };
    
    const handleOffline = () => {
      setIsOnline(false);
    };
    
    window.addEventListener('online', handleOnline);
    window.addEventListener('offline', handleOffline);
    
    return () => {
      window.removeEventListener('online', handleOnline);
      window.removeEventListener('offline', handleOffline);
    };
  }, []);
  
  const addPendingQuery = useCallback((query: any) => {
    const queryWithId = {
      ...query,
      id: `offline-${Date.now()}`,
      timestamp: Date.now(),
      status: 'pending'
    };
    
    setPendingQueries(prev => [...prev, queryWithId]);
    
    // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
    localStorage.setItem('pendingQueries', JSON.stringify([...pendingQueries, queryWithId]));
    
    // æ³¨å†Œåå°åŒæ­¥
    if ('serviceWorker' in navigator && 'sync' in window.ServiceWorkerRegistration.prototype) {
      navigator.serviceWorker.ready.then(registration => {
        registration.sync.register('query-sync');
      });
    }
    
    return queryWithId;
  }, [pendingQueries]);
  
  const syncPendingQueries = useCallback(async () => {
    if (!isOnline || pendingQueries.length === 0) return;
    
    for (const query of pendingQueries) {
      try {
        // å°è¯•æäº¤æŸ¥è¯¢
        await submitQuery(query);
        
        // æˆåŠŸåä»å¾…å¤„ç†åˆ—è¡¨ç§»é™¤
        setPendingQueries(prev => prev.filter(q => q.id !== query.id));
      } catch (error) {
        console.error('åŒæ­¥æŸ¥è¯¢å¤±è´¥:', error);
      }
    }
    
    // æ›´æ–°æœ¬åœ°å­˜å‚¨
    localStorage.setItem('pendingQueries', JSON.stringify(pendingQueries));
  }, [isOnline, pendingQueries]);
  
  return {
    isOnline,
    pendingQueries,
    addPendingQuery,
    syncPendingQueries
  };
}

// ç¦»çº¿æç¤ºç»„ä»¶
function OfflineIndicator() {
  const { isOnline, pendingQueries } = useOfflineCapability();
  
  if (isOnline) {
    return null;
  }
  
  return (
    <div className="offline-indicator" role="alert">
      <Icon name="wifi-off" />
      <div className="offline-content">
        <div className="offline-title">å½“å‰å¤„äºç¦»çº¿çŠ¶æ€</div>
        <div className="offline-description">
          æ‚¨å¯ä»¥ç»§ç»­ä½¿ç”¨åº”ç”¨ï¼ŒæŸ¥è¯¢å°†åœ¨ç½‘ç»œæ¢å¤åè‡ªåŠ¨åŒæ­¥
        </div>
        {pendingQueries.length > 0 && (
          <div className="pending-queries">
            {pendingQueries.length} ä¸ªæŸ¥è¯¢ç­‰å¾…åŒæ­¥
          </div>
        )}
      </div>
    </div>
  );
}
```

---

## ğŸ§ª æµ‹è¯•ä¸éªŒè¯

### ğŸ” å“åº”å¼è®¾è®¡æµ‹è¯•

```typescript
// å“åº”å¼è®¾è®¡æµ‹è¯•å·¥å…·
class ResponsiveTestSuite {
  private viewports = {
    mobile: { width: 375, height: 667 },
    tablet: { width: 768, height: 1024 },
    desktop: { width: 1920, height: 1080 }
  };
  
  async testResponsiveLayout(url: string) {
    const results = [];
    
    for (const [device, viewport] of Object.entries(this.viewports)) {
      const result = await this.testViewport(url, device, viewport);
      results.push(result);
    }
    
    return results;
  }
  
  private async testViewport(url: string, device: string, viewport: any) {
    // ä½¿ç”¨Playwrightè¿›è¡Œå“åº”å¼æµ‹è¯•
    const browser = await playwright.chromium.launch();
    const page = await browser.newPage();
    
    await page.setViewportSize(viewport);
    await page.goto(url);
    
    // æµ‹è¯•å…³é”®å…ƒç´ æ˜¯å¦å¯è§
    const tests = [
      {
        name: 'å¯¼èˆªèœå•å¯è§æ€§',
        test: () => page.locator('[data-testid="navigation"]').isVisible()
      },
      {
        name: 'æŸ¥è¯¢è¾“å…¥æ¡†å¯ç”¨æ€§',
        test: () => page.locator('[data-testid="query-input"]').isEnabled()
      },
      {
        name: 'å†…å®¹åŒºåŸŸå¸ƒå±€',
        test: async () => {
          const contentArea = page.locator('[data-testid="main-content"]');
          const boundingBox = await contentArea.boundingBox();
          return boundingBox && boundingBox.width > 0 && boundingBox.height > 0;
        }
      }
    ];
    
    const testResults = [];
    for (const test of tests) {
      try {
        const result = await test.test();
        testResults.push({ name: test.name, passed: result });
      } catch (error) {
        testResults.push({ name: test.name, passed: false, error: error.message });
      }
    }
    
    await browser.close();
    
    return {
      device,
      viewport,
      tests: testResults
    };
  }
}
```

### â™¿ å¯è®¿é—®æ€§è‡ªåŠ¨åŒ–æµ‹è¯•

```typescript
// å¯è®¿é—®æ€§æµ‹è¯•å¥—ä»¶
import { AxePuppeteer } from '@axe-core/puppeteer';

class AccessibilityTestSuite {
  async runAccessibilityAudit(url: string) {
    const browser = await puppeteer.launch();
    const page = await browser.newPage();
    
    await page.goto(url);
    
    // è¿è¡Œaxe-coreå¯è®¿é—®æ€§æµ‹è¯•
    const results = await new AxePuppeteer(page)
      .withTags(['wcag2a', 'wcag2aa', 'wcag21aa'])
      .analyze();
    
    await browser.close();
    
    return {
      violations: results.violations,
      passes: results.passes,
      incomplete: results.incomplete,
      inapplicable: results.inapplicable,
      score: this.calculateAccessibilityScore(results)
    };
  }
  
  private calculateAccessibilityScore(results: any): number {
    const totalTests = results.passes.length + results.violations.length;
    if (totalTests === 0) return 100;
    
    const passedTests = results.passes.length;
    return Math.round((passedTests / totalTests) * 100);
  }
  
  async testKeyboardNavigation(url: string) {
    const browser = await puppeteer.launch();
    const page = await browser.newPage();
    
    await page.goto(url);
    
    // æµ‹è¯•Tabé”®å¯¼èˆª
    const focusableElements = await page.$$eval(
      'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])',
      elements => elements.map(el => ({
        tagName: el.tagName,
        id: el.id,
        className: el.className,
        hasTabIndex: el.hasAttribute('tabindex')
      }))
    );
    
    // æ¨¡æ‹ŸTabé”®å¯¼èˆª
    const navigationResults = [];
    for (let i = 0; i < focusableElements.length; i++) {
      await page.keyboard.press('Tab');
      
      const activeElement = await page.evaluate(() => {
        const el = document.activeElement;
        return {
          tagName: el?.tagName,
          id: el?.id,
          className: el?.className,
          isVisible: el ? window.getComputedStyle(el).display !== 'none' : false
        };
      });
      
      navigationResults.push({
        step: i + 1,
        expectedElement: focusableElements[i],
        actualElement: activeElement,
        success: activeElement.isVisible
      });
    }
    
    await browser.close();
    
    return navigationResults;
  }
}
```

### ğŸ“± PWAåŠŸèƒ½æµ‹è¯•

```typescript
// PWAåŠŸèƒ½æµ‹è¯•
class PWATestSuite {
  async testPWAFeatures(url: string) {
    const browser = await puppeteer.launch();
    const page = await browser.newPage();
    
    await page.goto(url);
    
    const results = {
      manifest: await this.testManifest(page),
      serviceWorker: await this.testServiceWorker(page),
      installability: await this.testInstallability(page),
      offline: await this.testOfflineCapability(page)
    };
    
    await browser.close();
    return results;
  }
  
  private async testManifest(page: any) {
    const manifest = await page.evaluate(() => {
      const link = document.querySelector('link[rel="manifest"]');
      return link ? link.href : null;
    });
    
    if (!manifest) return { success: false, error: 'No manifest found' };
    
    try {
      const response = await page.goto(manifest);
      const manifestData = await response.json();
      
      return {
        success: true,
        data: manifestData,
        hasRequiredFields: !!(manifestData.name && manifestData.start_url && manifestData.icons)
      };
    } catch (error) {
      return { success: false, error: error.message };
    }
  }
  
  private async testServiceWorker(page: any) {
    const swRegistration = await page.evaluate(() => {
      return navigator.serviceWorker.getRegistration();
    });
    
    return {
      success: !!swRegistration,
      active: swRegistration?.active?.state === 'activated',
      scope: swRegistration?.scope
    };
  }
  
  private async testInstallability(page: any) {
    // æ£€æŸ¥beforeinstallpromptäº‹ä»¶
    const installable = await page.evaluate(() => {
      return new Promise((resolve) => {
        let prompted = false;
        
        window.addEventListener('beforeinstallprompt', () => {
          prompted = true;
          resolve(true);
        });
        
        setTimeout(() => {
          if (!prompted) resolve(false);
        }, 5000);
      });
    });
    
    return { installable };
  }
  
  private async testOfflineCapability(page: any) {
    // æ¨¡æ‹Ÿç¦»çº¿çŠ¶æ€
    await page.setOfflineMode(true);
    
    try {
      await page.reload();
      const content = await page.content();
      
      return {
        success: content.includes('html'),
        hasOfflinePage: content.includes('offline') || content.includes('ç¦»çº¿')
      };
    } catch (error) {
      return { success: false, error: error.message };
    } finally {
      await page.setOfflineMode(false);
    }
  }
}
```

---

## ğŸ“š æœ€ä½³å®è·µæ€»ç»“

### âœ… å“åº”å¼è®¾è®¡æœ€ä½³å®è·µ

1. **ç§»åŠ¨ä¼˜å…ˆè®¾è®¡**
   - ä»æœ€å°å±å¹•å°ºå¯¸å¼€å§‹è®¾è®¡
   - ä½¿ç”¨æ¸è¿›å¼å¢å¼ºè€Œéä¼˜é›…é™çº§
   - ä¼˜å…ˆè€ƒè™‘æ ¸å¿ƒåŠŸèƒ½å’Œå†…å®¹

2. **çµæ´»çš„ç½‘æ ¼ç³»ç»Ÿ**
   - ä½¿ç”¨CSS Gridå’ŒFlexbox
   - é¿å…å›ºå®šå®½åº¦å’Œé«˜åº¦
   - ä¿æŒé€‚å½“çš„å†…è¾¹è·å’Œå¤–è¾¹è·

3. **è§¦æ‘¸å‹å¥½çš„ç•Œé¢**
   - ç‚¹å‡»ç›®æ ‡è‡³å°‘44x44px
   - æä¾›è¶³å¤Ÿçš„é—´è·é¿å…è¯¯è§¦
   - æ”¯æŒå¸¸è§çš„æ‰‹åŠ¿æ“ä½œ

### âœ… å¯è®¿é—®æ€§æœ€ä½³å®è·µ

1. **è¯­ä¹‰åŒ–HTML**
   - ä½¿ç”¨æ­£ç¡®çš„HTMLæ ‡ç­¾
   - æä¾›æœ‰æ„ä¹‰çš„æ ‡é¢˜å±‚æ¬¡
   - ä½¿ç”¨åˆ—è¡¨ã€è¡¨æ ¼ç­‰ç»“æ„åŒ–å…ƒç´ 

2. **é”®ç›˜å¯¼èˆª**
   - ç¡®ä¿æ‰€æœ‰äº¤äº’å…ƒç´ å¯é€šè¿‡é”®ç›˜è®¿é—®
   - æä¾›æ¸…æ™°çš„ç„¦ç‚¹æŒ‡ç¤ºå™¨
   - æ”¯æŒå¿«æ·é”®å’Œè·³è¿‡é“¾æ¥

3. **å±å¹•é˜…è¯»å™¨æ”¯æŒ**
   - æä¾›é€‚å½“çš„ARIAæ ‡ç­¾
   - ä½¿ç”¨live regionsè¿›è¡ŒåŠ¨æ€å†…å®¹æ›´æ–°
   - æä¾›æœ‰æ„ä¹‰çš„æ›¿ä»£æ–‡æœ¬

### âŒ å¸¸è§è¯¯åŒº

1. **è¿‡åº¦ä¾èµ–åª’ä½“æŸ¥è¯¢**
   - é¿å…ä¸ºæ¯ä¸ªè®¾å¤‡åˆ›å»ºç‰¹å®šæ ·å¼
   - ä½¿ç”¨ç›¸å¯¹å•ä½è€Œéç»å¯¹åƒç´ 

2. **å¿½ç•¥æ€§èƒ½å½±å“**
   - å“åº”å¼å›¾ç‰‡ä¼˜åŒ–
   - é¿å…åŠ è½½ä¸å¿…è¦çš„èµ„æº

3. **å¯è®¿é—®æ€§åç½®**
   - ä»è®¾è®¡é˜¶æ®µå°±è€ƒè™‘å¯è®¿é—®æ€§
   - å®šæœŸè¿›è¡Œå¯è®¿é—®æ€§æµ‹è¯•

---

## ğŸ”— ç›¸å…³èµ„æº

- **WCAG 2.1æŒ‡å—**ï¼šhttps://www.w3.org/WAI/WCAG21/quickref/
- **PWAå¼€å‘æŒ‡å—**ï¼šhttps://web.dev/progressive-web-apps/
- **å“åº”å¼è®¾è®¡æ¨¡å¼**ï¼šhttps://responsivedesign.is/
- **CSS GridæŒ‡å—**ï¼šhttps://css-tricks.com/snippets/css/complete-guide-grid/
- **FlexboxæŒ‡å—**ï¼šhttps://css-tricks.com/snippets/css/a-guide-to-flexbox/

---

ğŸ’¡ **å®æ–½å»ºè®®**ï¼šæŒ‰ç…§ç¬¬4å‘¨çš„å¼€å‘è®¡åˆ’ï¼Œä»ç§»åŠ¨ç«¯å¼€å§‹è®¾è®¡ï¼Œé€æ­¥é€‚é…åˆ°æ›´å¤§å±å¹•ï¼ŒåŒæ—¶ç¡®ä¿æ¯ä¸ªåŠŸèƒ½éƒ½é€šè¿‡å¯è®¿é—®æ€§æµ‹è¯•ã€‚